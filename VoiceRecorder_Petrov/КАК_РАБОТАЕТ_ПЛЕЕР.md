# –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–ª–µ–µ—Ä (–ø—Ä–æ—Å—Ç–æ –∏ –ø–æ–Ω—è—Ç–Ω–æ)

## üéØ –ì–ª–∞–≤–Ω–∞—è –∏–¥–µ—è

–î–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∞—É–¥–∏–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º **MediaElement** –∏–∑ –ø–∞–∫–µ—Ç–∞ `CommunityToolkit.Maui.MediaElement`.

–≠—Ç–æ –≥–æ—Ç–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –æ—Ç Microsoft, –∫–æ—Ç–æ—Ä—ã–π —É–º–µ–µ—Ç:
- ‚úÖ –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å –∞—É–¥–∏–æ/–≤–∏–¥–µ–æ
- ‚úÖ –°—Ç–∞–≤–∏—Ç—å –Ω–∞ –ø–∞—É–∑—É
- ‚úÖ –ü–µ—Ä–µ–º–∞—Ç—ã–≤–∞—Ç—å (SeekTo)
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é –ø–æ–∑–∏—Ü–∏—é
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –æ–±—â—É—é –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

---

## üì¶ –ß—Ç–æ –¥–æ–±–∞–≤–∏–ª–∏

### 1. NuGet –ø–∞–∫–µ—Ç
```xml
<PackageReference Include="CommunityToolkit.Maui.MediaElement" Version="7.0.0" />
```

### 2. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ MauiProgram.cs
```csharp
using CommunityToolkit.Maui;

builder.UseMauiCommunityToolkitMediaElement()
```

### 3. –ö–ª–∞—Å—Å SimpleAudioPlayer
–ü—Ä–æ—Å—Ç–∞—è –æ–±–µ—Ä—Ç–∫–∞ –Ω–∞–¥ MediaElement –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–ª–µ–µ—Ä–∞

### SimpleAudioPlayer.cs (–ø—Ä–æ—Å—Ç–æ–π –∫–ª–∞—Å—Å)

```csharp
public class SimpleAudioPlayer
{
    private MediaElement _mediaElement;  // –ì–ª–∞–≤–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –∞—É–¥–∏–æ
    
    public async Task Play(string filePath)  // –ó–∞–ø—É—Å—Ç–∏—Ç—å
    public void Pause()                       // –ü–∞—É–∑–∞
    public void Resume()                      // –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å
    public void Stop()                        // –°—Ç–æ–ø
    public void SeekTo(double seconds)        // –ü–µ—Ä–µ–º–æ—Ç–∞—Ç—å
    public double GetCurrentPosition()        // –¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è
    public double GetDuration()               // –û–±—â–µ–µ –≤—Ä–µ–º—è
    public bool IsPlaying                     // –ò–≥—Ä–∞–µ—Ç –ª–∏?
}
```

---

## üéÆ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç —Ñ—É–Ω–∫—Ü–∏–∏

### 1. –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
```csharp
// –í SimpleAudioPlayer.cs
public async Task Play(string filePath)
{
    // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–∞–π–ª
    _mediaElement.Source = MediaSource.FromFile(filePath);
    
    // –ó–∞–ø—É—Å–∫–∞–µ–º
    _mediaElement.Play();
}
```

### 2. –ü–∞—É–∑–∞
```csharp
public void Pause()
{
    _mediaElement?.Pause();  // –ü—Ä–æ—Å—Ç–æ –≤—ã–∑—ã–≤–∞–µ–º –º–µ—Ç–æ–¥ Pause
}
```

### 3. –í–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
```csharp
public void Resume()
{
    _mediaElement?.Play();  // –ü—Ä–æ—Å—Ç–æ –≤—ã–∑—ã–≤–∞–µ–º –º–µ—Ç–æ–¥ Play —Å–Ω–æ–≤–∞
}
```

### 4. –ü–µ—Ä–µ–º–æ—Ç–∫–∞
```csharp
public void SeekTo(double seconds)
{
    // SeekTo –ø—Ä–∏–Ω–∏–º–∞–µ—Ç TimeSpan (–≤—Ä–µ–º—è)
    _mediaElement.SeekTo(TimeSpan.FromSeconds(seconds));
}
```

### 5. –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏
```csharp
public double GetCurrentPosition()
{
    // Position –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç TimeSpan, –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ —Å–µ–∫—É–Ω–¥—ã
    return _mediaElement.Position.TotalSeconds;
}
```

### 6. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
```csharp
public bool IsPlaying
{
    get
    {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–ª–µ–µ—Ä–∞
        var state = _mediaElement.CurrentState.ToString();
        return state == "Playing";
    }
}
```

---

## üé¨ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ PlayerPage

### –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø–ª–µ–µ—Ä–∞:
```csharp
private async void StartPlayback()
{
    // –ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å–∫–∞–µ–º –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
    await _audioService.PlayRecording(_recording.FilePath);
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–∫–æ–Ω–∫—É –ø–∞—É–∑—ã
    PlayIcon.IsVisible = false;
    PauseIcon.IsVisible = true;
    
    // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞–∂–¥—ã–µ 200ms
    _timer = new System.Threading.Timer(_ => UpdateProgress(), ...);
}
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞:
```csharp
private void UpdateProgress()
{
    // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â—É—é –ø–æ–∑–∏—Ü–∏—é
    var currentPosition = _audioService.GetCurrentPosition();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–π–º–µ—Ä
    CurrentTimeLabel.Text = FormatTime(currentPosition);
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ª–∞–π–¥–µ—Ä
    SeekSlider.Value = currentPosition;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä
    ProgressBar.Progress = currentPosition / _recording.DurationSeconds;
}
```

### –ü–∞—É–∑–∞/–ü–ª–µ–π:
```csharp
private void OnPlayPauseClicked(object sender, EventArgs e)
{
    if (_audioService.IsPlaying())
    {
        // –°—Ç–∞–≤–∏–º –Ω–∞ –ø–∞—É–∑—É
        _audioService.PausePlayback();
        PlayIcon.IsVisible = true;
        PauseIcon.IsVisible = false;
    }
    else
    {
        // –í–æ–∑–æ–±–Ω–æ–≤–ª—è–µ–º
        _audioService.ResumePlayback();
        PlayIcon.IsVisible = false;
        PauseIcon.IsVisible = true;
    }
}
```

### –ü–µ—Ä–µ–º–æ—Ç–∫–∞ –Ω–∞–∑–∞–¥:
```csharp
private void OnBackwardClicked(object sender, EventArgs e)
{
    var currentPos = _audioService.GetCurrentPosition();
    var newPosition = Math.Max(0, currentPos - 10);  // –ù–µ –º–µ–Ω—å—à–µ 0
    _audioService.SeekTo(newPosition);
}
```

### –ü–µ—Ä–µ–º–æ—Ç–∫–∞ –≤–ø–µ—Ä–µ–¥:
```csharp
private void OnForwardClicked(object sender, EventArgs e)
{
    var currentPos = _audioService.GetCurrentPosition();
    var newPosition = Math.Min(_recording.DurationSeconds, currentPos + 10);
    _audioService.SeekTo(newPosition);
}
```

### –ü–µ—Ä–µ–º–æ—Ç–∫–∞ —Å–ª–∞–π–¥–µ—Ä–æ–º:
```csharp
private void OnSeekSliderValueChanged(object sender, ValueChangedEventArgs e)
{
    _audioService.SeekTo(e.NewValue);  // –ü–µ—Ä–µ–º–∞—Ç—ã–≤–∞–µ–º –∫—É–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—Ç–∞—â–∏–ª
}
```

---

## ‚úÖ –ß—Ç–æ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç

| –§—É–Ω–∫—Ü–∏—è | –°—Ç–∞—Ç—É—Å |
|---------|--------|
| –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| –ü–∞—É–∑–∞ | ‚úÖ –†–µ–∞–ª—å–Ω–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–≤—É–∫ |
| –í–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ | ‚úÖ –ü—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Å —Ç–æ–≥–æ –∂–µ –º–µ—Å—Ç–∞ |
| –ü–µ—Ä–µ–º–æ—Ç–∫–∞ –Ω–∞–∑–∞–¥ (-10 —Å–µ–∫) | ‚úÖ –†–µ–∞–ª—å–Ω–æ –ø–µ—Ä–µ–º–∞—Ç—ã–≤–∞–µ—Ç |
| –ü–µ—Ä–µ–º–æ—Ç–∫–∞ –≤–ø–µ—Ä–µ–¥ (+10 —Å–µ–∫) | ‚úÖ –†–µ–∞–ª—å–Ω–æ –ø–µ—Ä–µ–º–∞—Ç—ã–≤–∞–µ—Ç |
| –°–ª–∞–π–¥–µ—Ä | ‚úÖ –†–µ–∞–ª—å–Ω–æ –ø–µ—Ä–µ–º–∞—Ç—ã–≤–∞–µ—Ç |
| –¢–∞–π–º–µ—Ä | ‚úÖ –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 200ms |
| –ü—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä | ‚úÖ –î–≤–∏–≥–∞–µ—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ |
| –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ | ‚úÖ –ú–æ–∂–Ω–æ —Å–ª—É—à–∞—Ç—å —Å–∫–æ–ª—å–∫–æ —É–≥–æ–¥–Ω–æ —Ä–∞–∑ |

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### MediaElement - —ç—Ç–æ —á—Ç–æ?

**MediaElement** - –≥–æ—Ç–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏–∑ .NET MAUI Community Toolkit.

**–ß—Ç–æ —É–º–µ–µ—Ç:**
- –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å —Ñ–∞–π–ª—ã (wav, mp3, m4a –∏ –¥—Ä.)
- –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ (Play, Pause, Stop)
- –ü–µ—Ä–µ–º–∞—Ç—ã–≤–∞—Ç—å (SeekTo)
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–∑–∏—Ü–∏—é (Position)
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (Duration)
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ (CurrentState)

### –ü–æ—á–µ–º—É MediaElement –∞ –Ω–µ AudioPlayer?

`AudioPlayer` –∏–∑ Plugin.AudioRecorder - **–æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ–π**:
- ‚ùå –ù–µ—Ç –ø–∞—É–∑—ã (—Ç–æ–ª—å–∫–æ Play/Stop)
- ‚ùå –ù–µ—Ç –ø–µ—Ä–µ–º–æ—Ç–∫–∏
- ‚ùå –ù–µ—Ç —Ç–µ–∫—É—â–µ–π –ø–æ–∑–∏—Ü–∏–∏
- ‚ùå –ù–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è

`MediaElement` –∏–∑ CommunityToolkit - **–ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π**:
- ‚úÖ –ï—Å—Ç—å –ø–∞—É–∑–∞
- ‚úÖ –ï—Å—Ç—å –ø–µ—Ä–µ–º–æ—Ç–∫–∞ (SeekTo)
- ‚úÖ –ï—Å—Ç—å –ø–æ–∑–∏—Ü–∏—è (Position)
- ‚úÖ –ï—Å—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ (CurrentState)

---

## üìù –ü—Ä–æ—Å—Ç–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –¥–ª—è –∑–∞—â–∏—Ç—ã

**–í–æ–ø—Ä–æ—Å:** –ö–∞–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–µ—Ä–µ–º–æ—Ç–∫–∞?  
**–û—Ç–≤–µ—Ç:** –ß–µ—Ä–µ–∑ –º–µ—Ç–æ–¥ `SeekTo(TimeSpan)` —É MediaElement. –ü–µ—Ä–µ–¥–∞–µ–º –Ω—É–∂–Ω–æ–µ –≤—Ä–µ–º—è –∏ –ø–ª–µ–µ—Ä –ø–µ—Ä–µ–º–∞—Ç—ã–≤–∞–µ—Ç –∞—É–¥–∏–æ.

**–í–æ–ø—Ä–æ—Å:** –ü–æ—á–µ–º—É –ø–∞—É–∑–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç?  
**–û—Ç–≤–µ—Ç:** MediaElement –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–∞—É–∑—É –Ω–∞—Ç–∏–≤–Ω–æ. –ü—Ä–∏ –≤—ã–∑–æ–≤–µ `Pause()` –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è, –Ω–æ –ø–æ–∑–∏—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è. –ü—Ä–∏ `Play()` –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è —Å —Ç–æ–≥–æ –∂–µ –º–µ—Å—Ç–∞.

**–í–æ–ø—Ä–æ—Å:** –ö–∞–∫ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ–≥—Ä–µ—Å—Å?  
**–û—Ç–≤–µ—Ç:** –ö–∞–∂–¥—ã–µ 200ms —Ç–∞–π–º–µ—Ä –≤—ã–∑—ã–≤–∞–µ—Ç –º–µ—Ç–æ–¥ `UpdateProgress()`, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∞–µ—Ç —Ç–µ–∫—É—â—É—é –ø–æ–∑–∏—Ü–∏—é —á–µ—Ä–µ–∑ `GetCurrentPosition()` –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç UI.

**–í–æ–ø—Ä–æ—Å:** –ß—Ç–æ —Ç–∞–∫–æ–µ CommunityToolkit?  
**–û—Ç–≤–µ—Ç:** –≠—Ç–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –æ—Ç Microsoft —Å –≥–æ—Ç–æ–≤—ã–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ –¥–ª—è .NET MAUI. MediaElement - –æ–¥–∏–Ω –∏–∑ —Ç–∞–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.

---

## ‚úÖ –ò—Ç–æ–≥–æ

**–î–æ:**
- AudioPlayer –±–µ–∑ –ø–∞—É–∑—ã –∏ –ø–µ—Ä–µ–º–æ—Ç–∫–∏
- –ü–∞—É–∑–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∞
- –ü–µ—Ä–µ–º–æ—Ç–∫–∞ —Ç–æ–ª—å–∫–æ –≤–∏–∑—É–∞–ª—å–Ω–∞—è

**–ü–æ—Å–ª–µ:**
- MediaElement —Å –ø–æ–ª–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π
- –ü–∞—É–∑–∞ —Ä–µ–∞–ª—å–Ω–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç
- –ü–µ—Ä–µ–º–æ—Ç–∫–∞ —Ä–µ–∞–ª—å–Ω–æ –ø–µ—Ä–µ–º–∞—Ç—ã–≤–∞–µ—Ç
- –ú–æ–∂–Ω–æ —Å–ª—É—à–∞—Ç—å —Å–∫–æ–ª—å–∫–æ —É–≥–æ–¥–Ω–æ —Ä–∞–∑

---

**–í–µ—Ä—Å–∏—è:** 3.0  
**–î–∞—Ç–∞:** 15.12.2025  
**–ê–≤—Ç–æ—Ä:** –ü–µ—Ç—Ä–æ–≤ –ò–≤–∞–Ω

