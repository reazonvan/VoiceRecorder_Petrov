<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="VoiceRecorder_Petrov.MainPage"
             Title="Диктофон"
             BackgroundColor="#F5F5F5">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">

            <!-- Заголовок -->
            <Label Text="Диктофон" 
                   FontSize="32" 
                   FontAttributes="Bold"
                   HorizontalOptions="Center"
                   TextColor="#333333"/>

            <!-- Статус -->
            <Label x:Name="StatusLabel" 
                   Text="Готово к записи" 
                   FontSize="18"
                   HorizontalOptions="Center"
                   TextColor="#666666"/>

            <!-- Таймер записи -->
            <Border Padding="20"
                    Margin="0,20"
                    BackgroundColor="White"
                    Stroke="#DDDDDD"
                    StrokeThickness="1">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="15"/>
                </Border.StrokeShape>
                
                <VerticalStackLayout Spacing="10">
                    <Label x:Name="TimerLabel" 
                           Text="00:00" 
                           FontSize="48"
                           FontAttributes="Bold"
                           HorizontalOptions="Center"
                           TextColor="#007AFF"/>
                </VerticalStackLayout>
            </Border>

            <!-- Кнопка записи (Начать/Остановить) -->
            <Button x:Name="RecordButton"
                    Text="Начать запись"
                    FontSize="18"
                    FontAttributes="Bold"
                    BackgroundColor="#007AFF"
                    TextColor="White"
                    HeightRequest="60"
                    CornerRadius="30"
                    Clicked="OnRecordButtonClicked"/>

            <!-- Заголовок списка -->
            <Label Text="Мои записи" 
                   FontSize="24" 
                   FontAttributes="Bold"
                   Margin="0,20,0,10"
                   TextColor="#333333"/>

            <!-- Список записей -->
            <CollectionView x:Name="RecordingsCollection"
                            SelectionMode="None"
                            EmptyView="Нет записей. Создайте первую запись.">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Border Padding="15"
                                Margin="0,5"
                                BackgroundColor="White"
                                Stroke="#DDDDDD"
                                StrokeThickness="1">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="10"/>
                            </Border.StrokeShape>
                            
                            <Grid ColumnDefinitions="*,Auto,Auto" 
                                  ColumnSpacing="10">
                                
                                <!-- Информация о записи -->
                                <VerticalStackLayout Grid.Column="0" 
                                                     Spacing="5">
                                    <Label Text="{Binding Title}" 
                                           FontSize="16"
                                           FontAttributes="Bold"
                                           TextColor="#333333"/>
                                    <Label FontSize="14"
                                           TextColor="#666666">
                                        <Label.FormattedText>
                                            <FormattedString>
                                                <Span Text="{Binding FormattedDate}"/>
                                                <Span Text=" • "/>
                                                <Span Text="{Binding FormattedDuration}"/>
                                            </FormattedString>
                                        </Label.FormattedText>
                                    </Label>
                                    <Label Text="{Binding FormattedFileSize}" 
                                           FontSize="12"
                                           TextColor="#999999"/>
                                </VerticalStackLayout>

                                <!-- Кнопка воспроизведения -->
                                <Border Grid.Column="1"
                                        WidthRequest="50"
                                        HeightRequest="50"
                                        BackgroundColor="#007AFF"
                                        Stroke="Transparent"
                                        StrokeThickness="0">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="25"/>
                                    </Border.StrokeShape>
                                    <Border.GestureRecognizers>
                                        <TapGestureRecognizer Tapped="OnPlayButtonClicked" 
                                                              CommandParameter="{Binding .}"/>
                                    </Border.GestureRecognizers>
                                    
                                    <!-- Иконка Play -->
                                    <Path Data="M8,5.14V19.14L19,12.14L8,5.14Z"
                                          Fill="White"
                                          Aspect="Uniform"
                                          HeightRequest="20"
                                          WidthRequest="20"
                                          HorizontalOptions="Center"
                                          VerticalOptions="Center"/>
                                </Border>

                                <!-- Кнопка удаления -->
                                <Border Grid.Column="2"
                                        WidthRequest="50"
                                        HeightRequest="50"
                                        BackgroundColor="#FF3B30"
                                        Stroke="Transparent"
                                        StrokeThickness="0">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="25"/>
                                    </Border.StrokeShape>
                                    <Border.GestureRecognizers>
                                        <TapGestureRecognizer Tapped="OnDeleteButtonClicked" 
                                                              CommandParameter="{Binding .}"/>
                                    </Border.GestureRecognizers>
                                    
                                    <!-- Иконка Delete -->
                                    <Path Data="M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19M8,9H16V19H8V9M15.5,4L14.5,3H9.5L8.5,4H5V6H19V4H15.5Z"
                                          Fill="White"
                                          Aspect="Uniform"
                                          HeightRequest="22"
                                          WidthRequest="22"
                                          HorizontalOptions="Center"
                                          VerticalOptions="Center"/>
                                </Border>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>
